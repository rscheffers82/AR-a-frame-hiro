<!--
    display a cube
    replace the cube by another one every 5 sec, 5 times
    overlay the sides of a qube with an image
    rotate the cube on its axis
    scale the cube, when it's at its smallest, it should be  replaced
    create hiro card with QR code
 -->
<html>
  <head>
    <script src="https://aframe.io/releases/0.5.0/aframe.min.js"></script>
    <script src="https://rawgit.com/jeromeetienne/ar.js/master/aframe/build/aframe-ar.js"></script>
    <script>THREEx.ArToolkitContext.baseURL = 'https://rawgit.com/jeromeetienne/ar.js/master/three.js/'</script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/16.3.5/Tween.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
    <script src="https://d3js.org/d3-ease.v1.min.js"></script>
  </head>

  <body style='margin : 0px; overflow: hidden;'>
    <a-scene embedded artoolkit='sourceType: webcam;'>
        <img id="zoki" src="./images/zorana-square.jpg">
        <img id="stone" src="./images/stone-texture.jpg">
        <img id="skyTexture" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/sechelt.jpg">
        <img id="bi1" src="./images/bas-en-ilse-voor-hun-huis.jpg">
      </a-assets>

      <a-box id="photo-cube" color="#fafafc" depth="1" height="1" width="1" position="0 0 0" rotation="45 45 45"></a-box>

      <a-marker-camera preset='hiro'></a-marker-camera>
    </a-scene>

<script>
var cube = d3.select('#photo-cube');
var x = -1;
setTimeout(setImg(), 2500);

function up() {
  console.log('up');
  cube.transition()
      .delay(0)
      .duration(2000)
      .ease('ease')
      .attrTween('scale', function() {
        return d3.interpolate('0 0 0','1 1 1')
      })
      .each('end', rotate);
}

function rotate() {
  cube.transition()
      .duration(2000)
      .attrTween('rotation', function() {
        return d3.interpolate('45 45 45', '45 405 45')
      })
      .each('end', down);
}

function down() {
  cube.transition()
      .delay(0)  // Delay before the cube returns to original position
      .duration(1000)
      .ease('ease')
      .attrTween('scale', function() {
        return d3.interpolate('1 1 1', '0 0 0')
      })
      .each('end', setImg);
}

function setImg() {
  (x < 3) ? x += 1 : x = 0;
  var images = [
    './images/zorana-square.jpg',
    './images/bas-en-ilse-voor-hun-huis.jpg',
    './images/stone-texture.jpg',
    './images/bas-en-ilse-binnen-drinken.jpg'
  ];

  var cubeEl = document.getElementById('photo-cube');
  cubeEl.setAttribute('src', images[x]);
  up();
}
</script>

    <script>
      //
      // var up, down, rotate;
      // var cube;
      // var position, rotation;
      //
			// init();
			// animate();
      //
			// function init() {
      //   position = { x: 0, y: 0, z: 0 }
      //   cube = document.getElementById('photo-cube');
      //   up = new TWEEN.Tween(position)
      //     .to({ x: 0, y: 1.25, z: 0 })
      //     .easing(TWEEN.Easing.Elastic.InOut)
      //     .onUpdate(update);
      //
      //   down = new TWEEN.Tween(position)
      //     .to({ x: 0, y: 0, z: 0 })
      //     .easing(TWEEN.Easing.Elastic.InOut)
			// 		.onUpdate(update);
      //
      //   up.chain(down);
      //   down.chain(up);
      //
      //   up.start();
      // }
      //
			// function animate( time ) {
			// 	requestAnimationFrame( animate );
			// 	TWEEN.update( time );
			// }
      //
			// function update() {
      //   // Positioning
      //   cube.setAttribute();
			// 	// target.style.left = position.x + 'px';
			// 	// target.style.top = position.y + 'px';
			// 	// target.style.webkitTransform = 'rotate(' + Math.floor(position.rotation) + 'deg)';
			// 	// target.style.MozTransform = 'rotate(' + Math.floor(position.rotation) + 'deg)';
      //
			// }
		</script>
  </body>
</html>
<!--
Texture on each face of the cube:
https://stackoverflow.com/questions/17418118/three-js-cube-with-different-texture-on-each-face

Animations
https://stackoverflow.com/questions/37649822/chain-linking-animations-with-aframe-io
https://github.com/tweenjs/tween.js
https://stackoverflow.com/questions/40417513/how-to-add-tags-dynamically-in-aframe-webvr


-->
<!-- <a-animation attribute="scale" from="0 0 0" to="1 1 1" direction="alternate" dur="4000" repeat="indefinite" animationstart=""></a-animation> -->
<!-- the above is within the box -->
<!-- place back into a-box once done -->
<!-- <a-animation
  attribute="rotation"
  from="45 45 45"
  to="45 225 45"
  direction="alternate"
  dur="4000"
  repeat="indefinite"
  easing="ease">
</a-animation> -->
<!-- <a-animation attribute="position" to="0 1.25 0" direction="alternate" dur="4000" repeat="indefinite"></a-animation> -->

<!-- <a-entity visible="false">
<a-text value="Behold the cube..." color="#CCC" position="0 1.5 0" scale="1"></a-text>
<a-animation attribute="visible" begin="5000" to="true" ></a-animation>
</a-entity> -->
